# Fix: All branchId Parameters Showing Same Example Value

## Root Cause

All endpoints in `branchesRouter.js` use the **same single example value**:

```javascript
parameters:
  - in: path
    name: branchId
    example: 123456789  // ← Same value in all 6 endpoints
```

## Solution Options

### Option 1: Use Different Single Example Values (Quick Fix)

Change each endpoint to use a unique example value:

```javascript
// /branches/{branchId}
parameters:
  - in: path
    name: branchId
    example: 111111111111111  // Unique for this endpoint

// /branches/{branchId}/fuelpass-limit
parameters:
  - in: path
    name: branchId
    example: 222222222222222  // Different for fuelpass

// /branches/{branchId}/marketing-actions/sticker
parameters:
  - in: path
    name: branchId
    example: 333333333333333  // Different for marketing
```

### Option 2: Use Multiple Examples Per Endpoint (Recommended)

Use `examples` (plural) with context-specific named examples:

```javascript
/**
 * @swagger
 * /branches/{branchId}/fuelpass-limit:
 *   get:
 *     parameters:
 *       - in: path
 *         name: branchId
 *         required: true
 *         schema:
 *           type: integer
 *           format: int64
 *         description: Şubenin idsi
 *         examples:
 *           active:
 *             summary: Active branch with fuelpass
 *             description: Branch that has an active fuelpass limit
 *             value: 111111111111111
 *           inactive:
 *             summary: Inactive branch
 *             description: Branch without fuelpass
 *             value: 222222222222222
 */
```

### Option 3: Use Component Parameter Reference (DRY)

Define a shared parameter component with default examples, then override where needed:

**Step 1:** Define the component (add to any JSDoc file):

```javascript
/**
 * @swagger
 * components:
 *   parameters:
 *     BranchIdParam:
 *       name: branchId
 *       in: path
 *       required: true
 *       description: Şube kimlik numarası (uzun tam sayı formatında)
 *       schema:
 *         type: integer
 *         format: int64
 *         minimum: 1
 *       examples:
 *         default:
 *           summary: Default branch ID
 *           value: 123456789012345
 *         test:
 *           summary: Test branch ID
 *           value: 987654321098765
 */
```

**Step 2:** Use the component in most endpoints:

```javascript
/**
 * @swagger
 * /branches/{branchId}:
 *   get:
 *     parameters:
 *       - $ref: '#/components/parameters/BranchIdParam'
 */
```

**Step 3:** Override with specific examples where needed:

```javascript
/**
 * @swagger
 * /branches/{branchId}/fuelpass-limit:
 *   get:
 *     parameters:
 *       - in: path
 *         name: branchId
 *         required: true
 *         schema:
 *           type: integer
 *           format: int64
 *         description: Branch ID for fuelpass limit check
 *         examples:
 *           active:
 *             summary: Active branch
 *             value: 111111111111111
 *           inactive:
 *             summary: Inactive branch
 *             value: 222222222222222
 */
```

## Why This Happens

The confytome processor correctly handles:
- ✅ Multiple examples per parameter
- ✅ Component parameter references
- ✅ $ref resolution in examples

But it can only work with what's in the OpenAPI spec. If the JSDoc defines:
- Same `example` value → All endpoints show same value
- Different `examples` → Each endpoint shows unique values

## Current State in branchesRouter.js

All 6 endpoints have:
```javascript
example: 123456789
```

This causes the documentation to show `123456789` for all endpoints.

## Recommended Approach

**For your use case (8 different branch operations):**

1. **Use Option 2** for endpoints that need context-specific examples:
   - fuelpass-limit → active/inactive branches
   - marketing → eligible branches
   - invoices → branches with/without invoices
   - debts → branches with overdue debts

2. **Use Option 3** for generic "Get branch details" endpoint:
   - Reference `BranchIdParam` component
   - Gets default examples

## Example Implementation

**File: branchesRouter.js (beginning)**

```javascript
/**
 * @swagger
 * components:
 *   parameters:
 *     BranchIdParam:
 *       name: branchId
 *       in: path
 *       required: true
 *       description: Şube kimlik numarası (uzun tam sayı formatında)
 *       schema:
 *         type: integer
 *         format: int64
 *         minimum: 1
 *         maximum: 9223372036854775807
 *       examples:
 *         default:
 *           summary: Varsayılan şube ID
 *           description: Standart şube kimlik numarası
 *           value: 123456789012345
 *         test:
 *           summary: Test şube ID
 *           value: 987654321098765
 */

/**
 * @swagger
 * /branches/{branchId}:
 *   get:
 *     tags:
 *       - Branches
 *     summary: Şube Detaylarını Getir
 *     description: |
 *       Belirtilen şube için detaylı bilgileri (firma, temsilciler, vb.) getirir.
 *
 *       **DataService (Eski) Adı:** SearchBranchCode
 *     parameters:
 *       - $ref: '#/components/parameters/BranchIdParam'
 *     responses:
 *       200:
 *         description: Şube detayları başarıyla getirildi
 *         # ... rest of response
 */

/**
 * @swagger
 * /branches/{branchId}/fuelpass-limit:
 *   get:
 *     tags:
 *       - Branches
 *     summary: Şube Yakıt Kartı Limitini Getir
 *     description: |
 *       Belirtilen şube için mevcut yakıt kartı limit tutarını getirir.
 *
 *       **DataService (Eski) Adı:** FuelPassLimitInfo
 *     parameters:
 *       - in: path
 *         name: branchId
 *         required: true
 *         schema:
 *           type: integer
 *           format: int64
 *         description: Şubenin idsi (yakıt kartı limiti için)
 *         examples:
 *           active:
 *             summary: Aktif yakıt kartı limiti olan şube
 *             description: Mevcut yakıt kartı limiti bulunan şube
 *             value: 111111111111111
 *           inactive:
 *             summary: Yakıt kartı limiti olmayan şube
 *             description: Limitsiz şube
 *             value: 222222222222222
 *     responses:
 *       200:
 *         description: Yakıt kartı limiti başarıyla getirildi
 *         # ... rest of response
 */
```

## Result After Fix

The markdown documentation will show:

**GET /branches/{branchId}:**
- Example: `default` - Varsayılan şube ID → 123456789012345
- Example: `test` - Test şube ID → 987654321098765

**GET /branches/{branchId}/fuelpass-limit:**
- Example: `active` - Aktif yakıt kartı limiti olan şube → 111111111111111
- Example: `inactive` - Yakıt kartı limiti olmayan şube → 222222222222222

**POST /branches/{branchId}/marketing-actions/sticker:**
- Example: `eligible` - Pazarlama aksiyonu için uygun şube → 333333333333333

## Testing

After updating the JSDoc:

```bash
# Regenerate OpenAPI spec
npx confytome openapi -c confytome/server-config.json -f branchesRouter.js

# Generate markdown
npx @confytome/markdown generate -s confytome/api-spec.json

# Check the results
grep -A 10 "Parameter Examples for" confytome/api-docs.md
```

## Version
- confytome@2.0.4
- Feature: ✅ $ref resolution in parameter examples (implemented)
- Issue: JSDoc uses same `example` value for all endpoints
